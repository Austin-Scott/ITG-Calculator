<!doctype html>
<html lang="en" data-bs-theme="dark">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-9ndCyUaIbzAi2FUVXJi0CjmCapSmO7SnpJef0486qhLnuZ2cdeRhO02iuK6FUUVM" crossorigin="anonymous">
    <title>ITG Calculator</title>
  </head>
  <body>

    <div class="container">
        <h1>ITG Calculator</h1>

        <form>
            <div class="input-group input-group-lg mt-3">
                <span class="input-group-text">BPM</span>
                <input type="number" class="form-control" id="inputBPM">
                <button class="btn btn-outline-success" type="button" onclick="solveForBPM()">Solve</button>
            </div>
            <div class="input-group input-group-lg mt-3">
                <span class="input-group-text">MINI</span>
                <input type="number" class="form-control" placeholder="0" id="inputMINI">
                <button class="btn btn-outline-success" type="button" onclick="solveForMini()">Solve</button>
            </div>
            <div class="input-group input-group-lg mt-3">
                <span class="input-group-text">NPS</span>
                <input type="number" class="form-control" id="inputNPS">
                <button class="btn btn-outline-success" type="button" onclick="solveForNPS()">Solve</button>
            </div>
            <div class="input-group input-group-lg mt-3">
                <span class="input-group-text">NOS</span>
                <input type="number" class="form-control" id="inputNOS">
                <button class="btn btn-outline-success" type="button" onclick="solveForNOS()">Solve</button>
            </div>
            <div class="input-group input-group-lg mt-3">
                <span class="input-group-text">RATE</span>
                <input type="number" class="form-control" placeholder="1.0" id="inputRATE">
                <button class="btn btn-outline-success" type="button" onclick="solveForRateMod()">Solve</button>
            </div>
            <div class="input-group input-group-lg mt-3">
                <span class="input-group-text">NTS</span>
                <input type="number" class="form-control" id="inputNTS">
                <button class="btn btn-outline-success" type="button" onclick="solveForNTS()">Solve</button>
            </div>
            <div class="input-group input-group-lg mt-3">
                <button class="btn btn-outline-danger w-100" type="button" onclick="clearAll()">Clear All</button>
            </div>
        </form>

    </div>

    <div class="modal" id="alertModal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="modalTitle">Modal title</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <p id="modalBody">Modal body text goes here.</p>
                </div>
            </div>
        </div>
    </div>

    <script src="main.js"></script>

    <script>
        
        const bpmInput = document.getElementById('inputBPM')
        const miniInput = document.getElementById('inputMINI')
        const npsInput = document.getElementById('inputNPS')
        const nosInput = document.getElementById('inputNOS')
        const rateInput = document.getElementById('inputRATE')
        const ntsInput = document.getElementById('inputNTS')

        function displayModal(title, body) {
            document.getElementById('modalTitle').innerText = title
            document.getElementById('modalBody').innerText = body
            const modal = new bootstrap.Modal(document.getElementById('alertModal'))
            modal.show()
        }

        function clearAll() {
            bpmInput.value = ''
            miniInput.value = ''
            npsInput.value = ''
            nosInput.value = ''
            rateInput.value = ''
            ntsInput.value = ''
        }

        function isNumeric(n) {
            return !isNaN(parseFloat(n)) && isFinite(n)
        }

        function solveForBPM() {
            if(!isNumeric(npsInput.value) || !isNumeric(nosInput.value)) {
                displayModal('Missing Field Values', 'BPM requires values of NPS and NOS (optionally MINI)')
                return
            }
            if(isNumeric(miniInput.value)) {
                bpmInput.value = beatsPerMinute(Number(npsInput.value), Number(nosInput.value), Number(miniInput.value))
            } else {
                bpmInput.value = beatsPerMinute(Number(npsInput.value), Number(nosInput.value), 0.0)
            }
        }
        function solveForMini() {
            if(!isNumeric(bpmInput.value) || !isNumeric(npsInput.value) || !isNumeric(nosInput.value)) {
                displayModal('Missing Field Values', 'MINI requires values of BPM, NPS, and NOS')
                return
            }
            miniInput.value = mini(Number(bpmInput.value), Number(npsInput.value), Number(nosInput.value))
        }
        function solveForNPS() {
            if(!isNumeric(bpmInput.value) || !isNumeric(nosInput.value)) {
                displayModal('Missing Field Values', 'NPS requires values of BPM and NOS (optionally MINI)')
                return
            }
            if(isNumeric(miniInput.value)) {
                npsInput.value = notesPerSecond(Number(bpmInput.value), Number(miniInput.value), Number(nosInput.value))
            } else {
                npsInput.value = notesPerSecond(Number(bpmInput.value), 0.0, Number(nosInput.value))
            }
        }
        function solveForNOS() {
            if(!isNumeric(bpmInput.value) || !isNumeric(npsInput.value)) {
                displayModal('Missing Field Values', 'NOS requires values of BPM and NPS (optionally MINI)')
                return
            }
            if(isNumeric(miniInput.value)) {
                nosInput.value = notesOnScreen(Number(bpmInput.value), Number(miniInput.value), Number(npsInput.value))
            } else {
                nosInput.value = notesOnScreen(Number(bpmInput.value), 0.0, Number(npsInput.value))
            }
        }
        function solveForRateMod() {
            if(!isNumeric(bpmInput.value) || !isNumeric(miniInput.value) || !isNumeric(ntsInput.value)) {
                displayModal('Missing Field Values', 'RATE requires values of BPM and NTS (optionally MINI)')
                return
            }
            if(isNumeric(miniInput.value)) {
                rateInput.value = rateMod(Number(bpmInput.value), Number(miniInput.value), Number(ntsInput.value))
            } else {
                rateInput.value = rateMod(Number(bpmInput.value), 0.0, Number(ntsInput.value))
            }
        }
        function solveForNTS() {
            if(!isNumeric(bpmInput.value)) {
                displayModal('Missing Field Values', 'NTS requires value of BPM (optionally MINI and RATE)')
                return
            }
            if(isNumeric(rateInput.value)) {
                if(isNumeric(miniInput.value)) {
                    ntsInput.value = noteTimeOnScreenSecondsWithMiniAndRateMod(Number(bpmInput.value), Number(miniInput.value), Number(rateInput.value))
                } else {
                    ntsInput.value = noteTimeOnScreenSecondsWithMiniAndRateMod(Number(bpmInput.value), 0.0, Number(rateInput.value))
                }
            } else {
                if(isNumeric(miniInput.value)) {
                    ntsInput.value = noteTimeOnScreenSecondsWithMiniAndRateMod(Number(bpmInput.value), Number(miniInput.value), 1.0)
                } else {
                    ntsInput.value = noteTimeOnScreenSecondsWithMiniAndRateMod(Number(bpmInput.value), 0.0, 1.0)
                }
            }
        }
    </script>

    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.8/dist/umd/popper.min.js" integrity="sha384-I7E8VVD/ismYTF4hNIPjVp/Zjvgyol6VFvRkX/vR+Vc4jQkC+hVqc2pM8ODewa9r" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js" integrity="sha384-geWF76RCwLtnZ8qwWowPQNguL3RmwHVBC9FhGdlKrxdiJJigb/j/68SIy3Te4Bkz" crossorigin="anonymous"></script>
  </body>
</html>
